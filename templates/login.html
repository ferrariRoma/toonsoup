<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <link rel="stylesheet" href="../static/css/signstyle.css">
</head>

<body>
    <div class="header">
        <h1 class="m-0 text-primary logo-toonsoup">íˆ°ìˆ²ğŸŒ³</h1>
    </div>
    <div class="container">
        <div class="wrap">
            <h1 class="title">ë¡œê·¸ì¸</h1>
            <form class="int-form" action="">
                <div class="int-area">
                    <input class="float-input input" id="id" name="id" type="text" autocomplete="off" required>
                    <label for="id" class="label">ì•„ì´ë””</label>
                </div>
                <div class="int-area">
                    <input class="float-input input" id="pw" name="pw" type="password" autocomplete="off" required>
                    <label for="pw" class="label">ë¹„ë°€ë²ˆí˜¸</label>
                </div>
                <div class="alert-area">
                    <p id="error-alert">ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ë¥¼ ì˜ëª» ì…ë ¥í–ˆìŠµë‹ˆë‹¤.<br>
                        ì…ë ¥í•˜ì‹  ë‚´ìš©ì„ ë‹¤ì‹œ í™•ì¸í•´ì£¼ì„¸ìš”.</p>
                </div>
                <div class="btn-area">
                    <button onclick="login()" class="btn" type="button">ë¡œê·¸ì¸</button>
                </div>
            </form>
            <hr>
            <div class="caption">
                <a href="/signup">
                    <p>TOONSOUP íšŒì›ì´ ì•„ë‹ˆì‹ ê°€ìš”? <span>ì§€ê¸ˆ ê°€ì…í•˜ì„¸ìš”.</span></p>
                </a>
            </div>
        </div>
    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script>
        // ì¸í’‹ì´ ë¹„ì–´ìˆìœ¼ë©´ ë²„íŠ¼ì„ ë¹„í™œì„±í™”

        $('.btn').attr('disabled', 'disabled');
        $(document).ready(function () {
            $('.int-form input').keyup(function () {

                var empty = false;
                $('.int-form input').each(function () {
                    if ($(this).val().length == 0) {
                        empty = true;
                    }
                });

                if (empty) {
                    $('.btn').attr('disabled', 'disabled');
                } else {
                    $('.btn').removeAttr('disabled');
                }
            });
        });

        // ë²„íŠ¼ì„ ëˆŒë €ì„ ë•Œ, DBì—ì„œ ì•„ì´ë””ë¥¼ ì°¾ê³ , ë¡œê·¸ì¸ì„ ì§„í–‰í•˜ëŠ” ì½”ë“œ
        const login = () => {
            let id = $('#id').val()
            let pw = $('#pw').val()

            $.ajax({
                type: "POST",
                url: "/login/post",
                data: {
                    id_give: id,
                    pw_give: pw
                },
                success: function (response) {
                    const account = response['account']

                    if (account.length === 0) {
                        $('#error-alert').show()
                    } else {
                        const accountId = account[0]['id']
                        const accountName = account[0]['name']
                        const accountPw = account[0]['pw']

                        if (pw != accountPw) {
                            $('#error-alert').show()
                        } else if (pw == accountPw) {
                            window.location.replace('/')
                        }
                    }
                }
            })
        }
    </script>
</body>

</html>